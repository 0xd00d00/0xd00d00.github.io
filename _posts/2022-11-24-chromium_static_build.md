---
layout: post
author: doodoo
title: "[Chromium] Chromium ì •ì (static linking) ë¹Œë“œí•˜ê¸°"
subtitle: "Chromium ì •ì ë¹Œë“œí•˜ê¸°!! ğŸ™ƒ"
date: 2022-11-24
cover: /assets/img/default.png
tags: Chromium C++
sitemap :
 changefreq : daily
 priority : 1.0
---
ì•ˆë…•í•˜ì„¸ìš”! <span class="doodoo">ë‘ë‘ì½”ë”©</span> ì…ë‹ˆë‹¤ âœ‹ <br>
ì˜¤ëŠ˜ì€ Chromium ì •ì ë¹Œë“œ ëŒ€í•´ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.

ğŸ–‡ ì†ŒìŠ¤ì½”ë“œì— ë§ˆìš°ìŠ¤ë¥¼ ì˜¬ë¦¬ê³  <span class="tip">copy</span> ë²„íŠ¼ì„ ëˆ„ë¥¼ ê²½ìš° ë” ì‰½ê²Œ ë³µì‚¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤! 

ê¶ê¸ˆí•œ ì , ë³´ì•ˆì  ë‚¨ê²¨ì£¼ì‹œë©´ ì„±ì‹¤íˆ ë‹µë³€í•˜ê² ìŠµë‹ˆë‹¤. ğŸ˜ <br>
\+ ê°ìƒí‰ ëŒ“ê¸€ë¡œ ë‚¨ê²¨ì£¼ì‹œë©´ í˜ì´ë©ë‹ˆë‹¤. ğŸ™‡

### Cloud serverì—ì„œ Chromium ë¹Œë“œ
Chromiumì„ Cloud serverì—ì„œ ë¹Œë“œí•œ í›„ ì‚°ì¶œëœ ê²°ê³¼ë¬¼ì„ ì–´ë–»ê²Œ ë³¼ ê²ƒì¸ê°€?

ê²°ê³¼ë¥¼ í™•ì¸í•˜ëŠ” ë°©ë²•ì—ëŠ” ë‘ ê°€ì§€ê°€ ì¡´ì¬í•œë‹¤. (ì´ì™¸ ë°©ë²•ì´ ë” ìˆë‹¤ë©´, ëŒ“ê¸€ë¡œ
		ê³µìœ ë¶€íƒë“œë¦°ë‹¤.)

1. ssh -X ë¥¼ í™œìš©í•œ GUI í™”ë©´ì„ ìš”ì²­í•˜ê¸° (xtrem í•„ìš”)
	- ê°€ì¥ ì‰½ê²Œ í™œìš©í•˜ëŠ” ë°©ë²•ì´ë‹¤. Ssh ì— -X ì˜µì…˜ì„ ì¶”ê°€í•´ cloudì— ì ‘ì†ì„ ìš”ì²­í•œ
	í›„ chrome ì‚°ì¶œë¬¼ì„ ì‹¤í–‰í•˜ë©´ëœë‹¤. (ì´ë•Œ, ë¹Œë“œ ì‚°ì¶œë¬¼ì€ chromiumì´ë¼ê³  ì „ì œí•œë‹¤.)

2. Cloud serverì—ì„œ ë¹Œë“œ ì‚°ì¶œë¬¼ì„ local directoryë¡œ ì˜®ê¸´ í›„ í™•ì¸í•œë‹¤.

### Build ì‚°ì¶œë¬¼ ì˜®ê¸°ê¸°
Build ì‚°ì¶œë¬¼ì„ ì˜®ê¸°ëŠ” ê°€ì¥ ê°„ë‹¨í•œ ë°©ë²•ì€ out/Default ë¼ëŠ” ì‚°ì¶œë¬¼ directoryë¥¼
ì „ì²´ localë¡œ ì˜®ê¸°ëŠ” ê²ƒì´ë‹¤. í•˜ì§€ë§Œ, localë¡œ ëª¨ë“  libraryë¥¼ ì§€ì†ì ìœ¼ë¡œ ì˜®ê¸°ê¸°ì—ëŠ”
ì‹œê°„ì´ ì˜¤ë˜ ê±¸ë¦°ë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.

ë³¸ì¸ ê°™ì€ ê²½ìš° chromium ì½”ë“œë¥¼ ë¶„ì„í•˜ê³  ë™ì‘ì„±ì„ ì•Œì•„ë³´ê¸° ìœ„í•´ ë¹Œë“œí•¨ìœ¼ë¡œ chromium ì‹¤í–‰íŒŒì¼ì„ ìˆ˜í–‰í•˜ê¸° ìœ„í•œ library ë“¤ë§Œ ì˜®ê¸°ë©´ ëœë‹¤. libcontent.so ì™€ ê°™ì€ chromium ì‹¤í–‰ì„ ìœ„í•œ libraryë§Œ ì˜®ê¸°ë©´ ë˜ëŠ”ë° ì–´ë–¤ libraryê°€ í•„ìš”í•œì§€ ì†”ì§íˆ ì˜ ì•Œì§€ ëª»í•œë‹¤. ë”°ë¼ì„œ, í•„ìš”í•œ libraryë¥¼ ì •ì ìœ¼ë¡œ ë¹Œë“œí•œ í›„ chromium ì‹¤í–‰íŒŒì¼ì„ localë¡œ ê°€ì ¸ì˜¤ëŠ” ë°©ë²•ì„ ì±„íƒí•˜ê³ ì í•œë‹¤.

Chromiumì€ ê¸°ë³¸ì ìœ¼ë¡œ ***dynamic linking***ì„ ì´ìš©í•œë‹¤.

### Dynamic Linking
Chromium ì€ ê¸°ë³¸ì ìœ¼ë¡œ Dynamic Linkingì„ ì±„íƒí•˜ê³  ìˆë‹¤. í™•ì¸í•´ë³´ê³ ì í•œë‹¤ë©´
ì•„ë˜ì˜ ëª…ë ¹ì–´ë¥¼ í†µí•´ í™•ì¸í•´ ë³¼ ìˆ˜ ìˆë‹¤.

```bash
$ gn args out/Default --list=is_component_build

# ìœ„ì˜ ëª…ë ¹ì–´ë¥¼ ì´ìš©í•œë‹¤ë©´ ê°ì¢… build ì„¤ì •ì„ ê²€ìƒ‰(ìì„¸í•œ ê±´ helpë¥¼ í†µí•´ë³´ì.) í•  ìˆ˜ ìˆë‹¤.
```

ìœ„ì˜ ëª…ë ¹ì–´ë¥¼ ìˆ˜í–‰í•œë‹¤ë©´, chromiumì—ì„œ ì™œ dynamic linkingì„ ì±„íƒí–ˆëŠ”ì§€ ë‚˜ì˜¨ë‹¤.

![dynamic linking](/assets/img/dynamic_linking.png)

ì„¤ëª…ê³¼ ê°™ì´, chromiumì—ì„œëŠ” ë¹Œë“œ ì†ë„ë¥¼ ë¹ ë¥´ê²Œ í•˜ê¸° ìœ„í•´ dynamic linkingì„
ì‚¬ìš©í•˜ê³  ìˆê³  í•„ìš”ì‹œ ë³€ê²½ë„ ê°€ëŠ¥í•˜ë‹¤. Cloud serverì—ì„œ í¸í•˜ê²Œ ê°€ì ¸ì˜¬ ìˆ˜ ìˆëŠ”
ë°©ë²•ìœ¼ë¡œ ***static library*** ì„¤ì •í•˜ëŠ” ë°©ë²•ê³¼ dynamic linkingê³¼ì˜ ì°¨ì´ë¥¼
ì•Œì•„ë³´ì.

### Static Linking
Chromium ë¹Œë“œë¥¼ staticìœ¼ë¡œ ë°”ê¾¸ëŠ” ë°©ë²•ì€ build ì„¤ì •ì„ ë°”ê¿”ì£¼ë©´ ëœë‹¤.

ê¸°ë³¸ì ìœ¼ë¡œ dynamic ê°™ì€ ê²½ìš° ***is_component_build*** flagê°€ ***true***ë¡œ
ì„¤ì •ë˜ì–´ìˆë‹¤. ì´ë¥¼ ***false*** ë¡œ ë³€ê²½í•´ì£¼ë©´ ì‰½ê²Œ static ë¹Œë“œê°€ ê°€ëŠ¥í•˜ë‹¤.

```bash
$ gn gen out/Default "--args=is_component_build=false"
```

Static linking ë¹Œë“œë¥¼ í•œ í›„ ê²°ê³¼ë¥¼ ë³¸ë‹¤ë©´ dynamic linking ë¹Œë“œì™€ ì°¨ì´ê°€
ì¡´ì¬í•œë‹¤.

1. chromeì„ êµ¬ì„±í•˜ê¸° ìœ„í•œ ê° ì¢… libraryë“¤ì„ ì°¾ì„ ìˆ˜ ì—†ë‹¤. (e.g. libcontent.so)
	- ì•„ë˜ì˜ ì‚¬ì§„ì„ ë³¸ë‹¤ë©´ ***out/Default*** ê°™ì€ ê²½ìš° dynamic liking ë¹Œë“œ ì‚°ì¶œë¬¼ì´ê³ , ***out/Realese***
	ê°™ì€ ê²½ìš° static linking ì‚°ì¶œë¬¼ì´ë‹¤. ê° ì‚°ì¶œë¬¼ì—ì„œ libcontent.so libraryë¥¼
	ì°¾ì•„ë³´ì•˜ë‹¤. ì°¾ì•„ë³¸ ê²°ê³¼ static linkingì—ì„œëŠ” ì°¾ì„ ìˆ˜ ì—†ì—ˆë‹¤. (tabì„ í•´ë„
			ì•ˆë‚˜ì˜´)

![dynamic vs static](/assets/img/dynamicVSstatic.png)

2. ì‚°ì¶œë¬¼ì˜ í¬ê¸°ê°€ ë‹¤ë¥´ë‹¤.
	- ë‹¹ì—° ê° ì¢… libraryë¥¼ í¬í•¨í•œ static linking ë¹Œë“œ ì‚°ì¶œë¬¼ì˜ ì‹¤í–‰íŒŒì¼ì˜ í¬ê¸°ê°€
	ë” ì»¸ë‹¤. ì•½ 300mb ì •ë„ ë” ë§ì€ ìš©ëŸ‰ì„ ì°¨ì§€ í–ˆë‹¤. (ë¹Œë“œ ì†ë„ì°¨ì´ëŠ” ë¹„êµëª»í–ˆì§€ë§Œ
			ì¢€ ë” ì˜¤ë˜ê±¸ë¦°ë‹¤ê³  í•œë‹¤.)

![capacity](/assets/img/dynamicVSstatic_capacity.png)

### Tip (faster ë¹Œë“œ)
Static buildë¥¼ í•˜ê³ ì í•œë‹¤ë©´ ì†ë„ê°€ ë¹Œë“œ ì†ë„ê°€ ì¢€ ë” ì˜¤ë˜ê±¸ë¦´ìˆ˜ë„ ìˆë‹¤. ì´
ë¬¸ì œë¥¼ ì•½ê°„ì´ë‚˜ë§ˆ ê°œì„ í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì„ ê³µìœ í•˜ê³ ì í•œë‹¤. ë§Œì•½ ë””ë²„ê¹…ì´ ì•„ë‹ˆë¼
ë™ì‘ì„± ì •ë¤ í•˜ê³ ì í•œë‹¤ë©´, debug modeì™€ symbolì„ ìµœì†Œí™”í•˜ì. Backtraceë¥¼ ì´ìš©í•´
í™•ì¸í•˜ê³ ì í•œë‹¤ë©´ symbolì€ ë‚¨ê²¨ë‘¬ì•¼í•  ê²ƒì´ë‹¤.

```bash
$ gn gen out/Default "--args=is_component_build=false is_debug = false symbol_level = 0"
```

### Reference
[chromium document](https://www.chromium.org/developers/gn-build-configuration)
