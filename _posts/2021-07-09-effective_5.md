---
layout: post
author: doodoo
title: "[Effective C++] ν•­λ© 3: λ‚μƒλ§ λ³΄μ΄λ©΄ constλ¥Ό λ“¤μ΄λ€μ! (1)"
subtitle: "1μ¥ C++μ— μ™”μΌλ©΄ C++μ λ²•μ„ λ”°λ¦…μ‹λ‹¤ π³"
date: 2021-07-09
cover: /assets/img/default.png
tags: Effective_C++ C++
sitemap :
  changefreq : daily
  priority : 1.0
---
Effective C++ μ±…μ„ μ½κ³  μ •λ¦¬ν•κ³  ν•©λ‹λ‹¤.

κ¶κΈν• μ , λ³΄μ•μ  λ‚¨κ²¨μ£Όμ‹λ©΄ μ„±μ‹¤ν λ‹µλ³€ν•κ² μµλ‹λ‹¤. π <br>
\+ κ°μƒν‰ λ“κΈ€λ΅ λ‚¨κ²¨μ£Όμ‹λ©΄ νμ΄λ©λ‹λ‹¤. π™‡

### μλ―Έμ μΈ μ μ•½ const
`const`μ κ°€μ¥ μ•„λ¦„λ‹¤μ΄ μ μ€ *μ†μ¤μ½”λ“ μμ¤€μ—μ„ μ‚¬μ©* κ³Ό *μ»΄νμΌλ¬κ°€ ν•΄λ‹Ή μ μ•½μ„
μ§€μΌμ¤* λ‘ κ°€μ§€ μΌ κ²ƒμ΄λ‹¤. ν”„λ΅κ·Έλλ¨Έκ°€ μ§€μ •ν• μ μ•½ μμ¤€μ„ μ»΄νμΌλ¬κ°€
μ§€μΌμ¤€λ‹¤ μ  μμ²΄κ°€ μ •λ§ ν”„λ΅κ·Έλλ° μ–Έμ–΄λ΅ μ»΄ν“¨ν„°μ™€ λ€ν™”ν•λ” λλ‚μ΄λ‹κΉ.. π

`const`λ” μ •λ§ λ‹¤λ°©λ©΄μ—μ„ λ§μ΄ μ‚¬μ©λλ‹¤. ν΄λμ¤ λ°”κΉ¥μ—μ„λ” "μ „μ—­" νΉμ€ "λ„¤μ„μ¤νμ΄μ¤" μ ν¨λ²”μ„λ¥Ό *μƒμ*λ΅ μ •μ λ° μ„ μ–Έμ„ ν•λ”λ° μ‚¬μ©ν•  μ μλ‹¤. ν΄λμ λ‚΄λ¶€μ κ²½μ°, "μ •μ λ©¤λ²„" λ° "λΉ„μ •μ  λ©¤λ²„" λ¨λ‘λ¥Ό μƒμλ΅ μ„ μ–Έ ν•  μ μλ‹¤.

ν¬μΈν„°κ°€ μ΅°κΈ κΉλ‹¤λ΅μΈ μ μλ”λ°, ν¬μΈν„°λ” *κ°€λ¦¬ν‚¤λ” λ€μƒ*μ„ μƒμν™” ν•  μ μκ³ ,
	*ν¬μΈν„° μμ²΄*λ¥Ό μƒμν™” ν•  μ μκ³ , λ‘ λ‹¤ μƒμν™”κ°€ κ°€λ¥ν•λ‹¤.

```cpp
char greeting [] = "Hello";
char halo [] = "halo";

char *p = greeting;		// λΉ„μƒμ ν¬μΈν„°, λΉ„μƒμ λ°μ΄ν„°

const char *p = greeting;		// λΉ„μƒμ ν¬μΈν„°, μƒμ λ°μ΄ν„°
								// ν¬μΈν„°κ°€ κ°€λ¦¬ν‚¤λ” λ€μƒ λ³€ν™” λ¶κ°€λ¥

char * const p = greeting;		// μƒμ ν¬μΈν„°, λΉ„μƒμ λ°μ΄ν„°
								// ν¬μΈν„° μμ²΄ μμ²΄ λ³€ν™” λ¶κ°€λ¥

const char * const p = greeting;		// μƒμ ν¬μΈν„°, μƒμ λ°μ΄ν„°
										// ν¬μΈν„°, κ°€λ¦¬ν‚¤λ” λ€μƒ λ¨λ‘ λ³€ν™” λ¶κ°€λ¥
```

μ¶”κ°€λ΅ μ„¤λ…ν•μλ©΄, `const char *p` λ΅ μ„ μ–Έλ μΌ€μ΄μ¤μ— λ§μ•½ `greeting`μ κ°’μ„ λ³€κ²½ν•κ³ μ ν•  κ²½μ° μ•„λμ™€ κ°™μ€ μ—λ¬λ¥Ό λ§λ‚κ² λλ‹¤.

```cpp
// λ³ΈμΈμ΄ g++λ΅ μ»΄νμΌ ν•  λ• λ§λ‚ μ—λ¬μ΄λ‹¤.
error: read-only variable is not assignable
```

μ¦‰, κ°’μ„ λ³€κ²½ν•  μ μ—†λ‹¤λ” μ—λ¬μ΄λ‹¤. ν•μ§€λ§, `halo` λΌλ” κ°’μΌλ΅ pointerλ¥Ό λ³€κ²½ν• 
κ²½μ° μ λ™μ‘ν•λ‹¤. μ΄μ™€ λ°λ€λ΅ μ•„λμ `char * const p`λ΅  `greeting` κ°’ μ¤‘ μΌλ¶€λ¥Ό λ³€κ²½ν•λ©΄ μ λ™μ‘ν•μ§€λ§, ν¬μΈν„°λ¥Ό `halo` λ³€κ²½ν•  κ²½μ° μ•„λμ™€ κ°™μ€ μ—λ¬λ¥Ό λ§λ‚  κ²ƒμ΄λ‹¤.

```cpp
// λ³ΈμΈμ΄ g++λ΅ μ»΄νμΌ ν•  λ• λ§λ‚ μ—λ¬μ΄λ‹¤.
error: cannot assign to variable 'p' with const-qualified type 'char *const'
```

λ§μ§€λ§‰ `pointer` μ™€ `variable` λ‘ λ‹¤μ— `const`λ¥Ό λ¶™μΌ κ²½μ° λ³€κ²½μ€ μ•„λ¬΄κ²ƒλ„
λμ§€μ•κ³  μ»΄νμΌ μ‹ μ—λ¬λ¥Ό λ§λ‚  κ²ƒμ΄λ‹¤.

κ·Έλ ‡λ‹¤λ©΄ μ΄κ±Έ μ–΄λ–»κ² κµ¬λ³„ν•  κ²ƒμΈκ°€? (μ–΄λ µμ§€ μ•λ‹¤..π¤—)

μ°λ¦¬λ” `* (pointer)` λ¥Ό κΈ°μ¤€μΌλ΅ μƒκ°ν•λ©΄ λλ‹¤. `* (pointer)` κΈ°μ¤€μΌλ΅ *μ™Όμ½*μ— μμ„ κ²½μ°
pointerκ°€ κ°€λ¦¬ν‚¤λ” λ€μƒμ„ μƒμν™” ν•λ” κ²ƒμ΄κ³  *μ¤λ¥Έμ½*μ— μμ„ κ²½μ° pointer μμ²΄λ¥Ό
μƒμν™” ν•λ” κ²ƒμ΄λ‹¤.

ν•­μƒ `* (pointer)` κΈ°μ¤€μΌλ΅ μƒκ°ν•΄μ•Όν•λ‹¤. μ•„λμ μμ‹λ¥Ό λ³΄μ.

```cpp
void f1 (const Widget *pw);		// ν¬μΈν„°κ°€ μ™Όμ½μ— μλ‹¤. λ”°λΌμ„ κ°€λ¦¬ν‚¤λ” λ€μƒμ΄ μƒμ

void f2 (Widget const *pw);		// f1κ³Ό λ™μΌ
```

μΌλ°μ μΌλ΅ λ¬Έμ¥μ„ λ³Ό λ•, `Type` κΈ°μ¤€μΌλ΅ λ³΄λ” κ²½ν–¥μ΄ μλ‹¤. `Widget` μ΄ μ•„λ‹
`* (pointer)` κΈ°μ¤€μΌλ΅ λ³΄μ. ν„μ—…μ—μ„ λ‘ κ°€μ§€λ‹¤ μ μ‚¬μ©ν•κ³  μκΈ° λ•λ¬Έμ— λ¬Έμ¥μ„
λ§λ‚¬μ„ λ• ν–‡κ°λ¦¬μ§€ λ§μ!

### STL λ°λ³µμ const
*STL λ°λ³µμ* λ” `* (pointer)`λ¥Ό λ³Έλ¬ κ²ƒμ΄λ‹¤. μ–΄λ–¤ λ°λ³µμλ¥Ό `const`λ΅ μ„ μ–Έν•λ”
κ²ƒμ€ ν¬μΈν„° μƒμν™” ν•λ” λ°©λ²•κ³Ό λ™μΌν•λ‹¤. λ°λ³µμ μ•μ— constλ¥Ό λ¶™μ΄κ² λ  κ²½μ°
*κ°€λ¦¬ν‚¤λ” λ€μƒμ μƒμν™”* κ°€λ¥ν•λ‹¤. λ§μ•½ *ν¬μΈν„°λ¥Ό μƒμν™”* ν•κΈ° μ„ν•΄μ„λ”
`const_iterator`λ΅ λ°λ³µμλ¥Ό μ„ μ–Έν•΄ μ‚¬μ©ν•λ©΄ λλ‹¤.

```cpp
/*
   it λ” const T* μ„ μ–Έκ³Ό λ™μΌν•κ² λ™μ‘ν•λ‹¤.
   κ°€λ¦¬ν‚¤λ” λ€μƒμ μƒμν™”
*/
const std::vector<int>::iterator it = vec.begin();

*it = 10;		// ν¬μΈν„° κ°’μ„ λ³€κ²½ν•λ” κ²ƒμ€ κ°€λ¥.
it++;			// κ°€λ¦¬ν‚¤λ” λ€μƒμ΄ μƒμν™” λκΈ° λ•λ¬Έμ— λ€μƒμ κ°’ λ³€κ²½ λ¶κ°€λ¥!

/*
  const_iterator μ‚¬μ©
  ν¬μΈν„°λ¥Ό μƒμν™”
*/
const std::vector<int>::const_iterator cIt = vec.begin();

*cIt = 10;		// μ—λ¬ λ°μƒ. ν¬μΈν„° κ°’ λ³€κ²½ λ¶κ°€λ¥
it++;		// κ°€λ¥ν•λ‹¤. ν¬μΈν„°κ°€ κ°€λ¦¬ν‚¤λ” λ€μƒμ— λ€ν•΄μ„  κ°’ λ³€κ²½ κ°€λ¥!
```

### const ν•¨μ μ„ μ–Έ
`const`μ κ°€μ¥ κ°•μ μ€ *ν•¨μ μ„ μ–Έ* ν•  λ• μ‚¬μ©ν•λ” κ²ƒμ΄λ‹¤. ν•¨μ μ„ μ–Έλ¬Έμ— μμ–΄
`const` λ” "λ°ν™κ°’", "κ°κ°μ λ§¤κ°λ³€μ" κ·Έλ¦¬κ³  "λ©¤λ²„ν•¨μ" μ• νΉμ€ μ „μ²΄μ— `const` μ„±μ§μ„ λ¶€μ—¬ν•  μλ„ μλ‹¤.

*π± ν•¨μμ λ°ν™κ°’μ„ constν™” ν•  κ²½μ°*

ν•¨μμ λ°ν™ κ°’μ— `const`λ¥Ό λ¶™μ—¬ μ¤„ κ²½μ° *μ•μ •μ„±μ΄λ‚ ν¨μ¨μ„ ν¬κΈ°ν•μ§€ μ•κ³ λ„
μ‚¬μ©μ μΈ΅μ—μ„ μ—λ¬κ°€ λ°μƒν•λ” μƒν™©*μ„ μ¤„μΌ μ μλ‹¤. μ•„λμ μμ‹λ¥Ό λ³΄μ.

```cpp
// μ λ¦¬μ ν΄λμ¤κ°€ μλ‹¤κ³  κ°€μ •ν•μ.
class Rational { ...  };

// λ©¤λ²„ ν•¨μ μ„ μ–Έ λ° μ •μ
const Rational operator*(const Rational& lhs, const Rational& rhs) {
	...
}

int main() {
	// μ‚¬μ©μ μΈ΅λ©΄μ—μ„ μ—λ¬λ¥Ό λ§λ‚κ² λ¨.
	if (a * b = c) ...
}
```

μ„μ™€ κ°™μ΄ ν•¨μμ λ°ν™κ°’μ„ μ„ μ–Έν•΄λ‘ κ²½μ° μ‚¬μ©μ μ…μ¥μ—μ„ `Rational` μ΄λΌλ”
μ‚¬μ©ν•  λ• μλ„μΉ μ•λ” λ¶€λ¶„μ—μ„ μ»΄νμΌ μ‹ μ—λ¬λ¥Ό λ¨Όμ € μ¶λ ¥ν•΄ μ¶”ν›„ *λ°νƒ€μ„ λ²„κ·Έ*
κ°€ λ‚λ” κ²ƒμ„ λ§‰μ„ μ μκ²ν•΄μ¤€λ‹¤.

μ„μ μ½”λ“μ—μ„ `if (a * b = c)` λ¶€λ¶„μ„ λ³΄μ. μ‚¬μ©μλ” `==` μ—°μ‚°μ„ ν†µν•΄ `a * b`
κ°’κ³Ό `c` κ°’μ„ λΉ„κµ ν•κ³  μ‹¶μ€λ°, (μ•Όκ·Όμ„ ν•΄ μ •μ‹ μ΄ νΌλ―Έν• μƒνƒμ—μ„.. π¤Ά) μλ»μ³
`=` ν•λ‚λ§ μ³¤λ‹¤κ³  κ°€μ •ν•΄λ³΄μ. λ§μ•½ `const`λ΅ μ„ μ–Έν•μ§€ μ•μ•λ‹¤λ©΄, compilerλ”
μ‚¬μ©μκ°€ `operator=`λ¥Ό λ¶€λ¥΄λ‚ λ³΄λ‹¤ ν•κ³  κ·Έλƒ¥ λ„μ–΄κ° μλ„ μκ³ , μ¶”ν›„ μ΄μƒν•
λ²„κ·Έκ°€ λ°μƒν•΄ ν•λ£¨μΆ…μΌ μ•Όκ·Όμ„ ν•΄μ•Όλ μλ„μλ‹¤..

ν•μ§€λ§, `const`λ¥Ό μ‘μ„±ν•  κ²½μ° μƒμμ— `=`μ„ μ‚¬μ©ν•λ‹¤λ” λ§λ„μ•λλ” λ¶€λ¶„μ„
μ»΄νμΌλ¬κ°€ λ―Έλ¦¬ μ‚¬μ©μμ—κ² μ—λ¬λ΅ μ•λ ¤μ¤„ κ²ƒμ΄λ‹¤.

π΄ ν¬μ¤ν… μ½λ” μ‹κ°„μ΄ λ„λ¬΄ κΈΈμ–΄μ§€λ©΄ μ§‘μ¤‘λ ¥μ΄ λ–¨μ–΄μ§„λ‹¤. *μ μ‹* μ¨ μΆ€ κ³ λ¥΄κ³  π®π’¨  [λ‹¤μ ν¬μ¤ν…](https://0xd00d00.github.io/2021/07/10/effective_6.html) μ„ λ³΄λ„λ΅ ν•μ.
