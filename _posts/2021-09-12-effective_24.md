---
layout: post
author: doodoo
title: "[Effective C++] 항목 18: 인터페이스 설계는 제대로 쓰기엔 쉽게, 엉터리로
쓰기엔 어렵게 하자(2)"
subtitle: "설계 및 선언 🔐"
date: 2021-09-12
cover: /assets/img/default.png
tags: Effective_C++ C++
sitemap :
 changefreq : daily
 priority : 1.0
---
안녕하세요! <span class="doodoo">두두코딩</span> 입니다 ✋ <br>
오늘은 좋은 인터페이스 만들기에 대해 알아보겠습니다.

[이전 포스팅]()을 참고하면 내용이해가 훨씬 수월합니다!

🖇 소스코드에 마우스를 올리고 <span class="tip">copy</span> 버튼을 누를 경우 더 쉽게 복사할 수 있습니다! 

궁금한 점, 보안점 남겨주시면 성실히 답변하겠습니다. 😁 <br>
\+ 감상평 댓글로 남겨주시면 힘이됩니다. 🙇

### 사용자 쪽에서 뭔가를 외워야 제대로 쓸 수 있는 인터페이스는 잘못쓰기 쉽다
사용자 쪽에서 외워서 사용하도록 만들면 사용자가 잘못 사용하기 쉬워진다.

```cpp
// factory 함수라 가정
Investment* createInvestment();
```

위의 함수를 사용할 때, 자원 누출을 피하기 위해 `createInvestment`에서 얻은
포인터를 나중에 삭제해야한다. 하지만 위와 같이 함수를 구성할 경우 사용자가 실수로 자원을 해제하지 않아 자원
누수가 발생할 수 있거나 똑같은 포인터에 대해 `delete`가 두 번일어 날 수 있다.

[이전 포스팅](https://0xd00d00.github.io/2021/08/17/effective_18.html)을 통해 `auto_ptr` 또는 `tr1::shared_ptr`를 할당 받아 해당
포인터를 직접 삭제하는 것이 아니라 *스마트포인터*를 통해 삭제하도록 구성했다.
하지만 이런 *스마트포인터*를 만든다는 것을 잊어먹고 프로그램을 완성하게 되면
어떻게 될까? 고치기가 힘들어진다. 따라서, 인터페이스를 만들때 부터
*스마트포인터*를 반환하도록 해 사용자에게 사용하도록 지시하는 것이 좋은
인터페이스 설계방법이다.

```cpp
std::tr1::shared_ptr<Investment> createInvestment();
```

위와 같이, 원시포인터를 반환받는 것이 아니라, *스마트포인터*를 반환받도록
구성해두면 사용자가 깜빡하고, *스마트포인터*를 안만들어 자원 누수를 하는
케이스를 배제시킬 수 있다.

사실 *tr1::shared_ptr*를 반환하는 구조는 *자원 누수*를 막는 것 뿐 아니라
상당수의 사용자 실수를 사전 봉쇄 할 수 있는 장점이 있다. 본인이 인터페이스
설계자라면 적극 기용하도록 하자!🙄

### 
